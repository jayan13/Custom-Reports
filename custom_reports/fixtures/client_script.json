[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Payment Entry",
  "enabled": 1,
  "modified": "2022-12-09 09:34:54.695131",
  "name": "Payment Entry-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Payment Entry', {\n\tposting_date: function(frm) {\n    if(frm.doc.posting_date && frm.doc.voucher_date )\n    {\n        if(frm.doc.voucher_date  > frm.doc.posting_date)\n        {\n            frm.doc.voucher_date = frm.doc.posting_date;\n            frm.refresh_fields();\n            frappe.throw(__(\"Posting date must be grater than or equal to voucher date\"));\n        }\n    }\n},\nvoucher_date: function(frm) {\n    if(frm.doc.posting_date && frm.doc.voucher_date )\n    {\n        if(frm.doc.voucher_date  > frm.doc.posting_date)\n        {\n            frm.doc.voucher_date = frm.doc.posting_date;\n            frm.refresh_fields();\n            frappe.throw(__(\"Posting date must be grater than or equal to voucher date\"));\n        }\n    }\n}\n})\n\nfrappe.ui.form.on('Payment Entry', {\n\tview_reference_details: function(frm) {\n\n\t    frappe.call({\n\t\t\t\tmethod: \"custom_reports.quotation.getorderdetails\",\n\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\tpayment: frm.doc.name,\n\t\t\t\t},\n\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\n\t\t\t\t\tif(p.message.length) {\n\t\t\t\t\t    \n\t\t\t\t\t    var msg='<style>table, th, td {  border: 1px solid #ebeef0;} th, td {  padding: 10px; }</style><table style=\"width:100%;\"><tr><th>Purchase order</th><th>Approved by User Name</th><th>Approved by User Id</th><th>Status</th><th>Amount</th></tr>';   \n\t\t\t\t\t$.each(p.message, function(i, qto) {\n\t\t\t\t\t\t\t\n\t\t\t\t\tmsg+='<tr><td>'+qto.order+'</td><td>'+qto.name+'</td><td>'+qto.user_name+'</td><td>'+qto.status+'</td><td>'+qto.amount+'</td></tr>';\t\n\t\t\t\t\t\n\t\t\t\t\t})\n\n\t\t\t\t\tmsg+='</table>';\n\t\t\t\t\t var d = new frappe.ui.Dialog({\n\t\t\t\t\t    title: 'Purchase Order Details',\n    'fields': [\n        {'fieldname': 'ht', 'fieldtype': 'HTML'},\n    ]\n});\nd.fields_dict.ht.$wrapper.html(msg);\nd.$wrapper.find('.modal-dialog').css(\"max-width\", \"90%\");\nd.$wrapper.find('.modal-dialog').css(\"width\", \"90%\");\nd.show();\n\t\t\t\t\t\t\n\t\t\t\t\t}else{\n\t\t\t\t\t    \n\t\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\ttitle: __('Purchase Order Details'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tmessage: __('Purchase Order Details are not available')\n\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t    \n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Company",
  "enabled": 1,
  "modified": "2022-10-05 15:59:11.875525",
  "name": "Company-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Company', {\n\tsetup(frm) {\n\t\tfrappe.call({\n        method: \"cheque_management.api.get_journal_naming_series\",\n        callback: function (r) {\n        \tif(r.message)\n\t\t\t{\n\t\t\t\n\t\t\t\tfrm.set_df_property('journal_entry_naming_series', 'options',r.message);\n\t\t\t\tfrm.set_df_property('payment_journal_entry_naming_series', 'options',r.message);\n\t\t\t\tfrm.set_df_property('journal_entry_ret_naming_series', 'options',r.message);\n\t\t\t\tfrm.set_df_property('payroll_jv_naming_series', 'options',r.message);\n\t\t\t\t\n                frm.refresh_field('journal_entry_naming_series');\n                frm.refresh_field('payment_journal_entry_naming_series');\n                frm.refresh_field('journal_entry_ret_naming_series');\n                frm.refresh_field('payroll_jv_naming_series');\n\t\t\t}\n        }\n    });\n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Sales Order",
  "enabled": 1,
  "modified": "2022-11-22 14:58:37.367431",
  "name": "Sales Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Sales Order',  {\n\t\n    customer: function(frm) {\n\t\t\tfrm.doc.overdue_days='';\n\t\t\tfrm.doc.credit_limit='';\n\t\t\tfrm.doc.customer_outstanding='';\n\t\tif (frm.doc.company && frm.doc.customer){\n\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_reports.api.customer_outstanding\",\n\t\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\t\tcompany: frm.doc.company,\n\t\t\t\t\t\tcustomer: frm.doc.customer,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(p.message) {\n\t\t\t\t\t\t\tfrm.doc.customer_outstanding=p.message\n\t\t\t\t\t\t\tfrm.refresh_field('customer_outstanding');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_reports.api.customer_overdue\",\n\t\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\t\tcompany: frm.doc.company,\n\t\t\t\t\t\tcustomer: frm.doc.customer,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(p.message) {\n\t\t\t\t\t\t\tfrm.doc.overdue_days=p.message\n\t\t\t\t\t\t\tfrm.refresh_field('overdue_days');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_reports.api.customer_credit\",\n\t\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\t\tcompany: frm.doc.company,\n\t\t\t\t\t\tcustomer: frm.doc.customer,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(p.message) {\n\t\t\t\t\t\t\tfrm.doc.credit_limit=p.message\n\t\t\t\t\t\t\tfrm.refresh_field('credit_limit');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n    \t} \n\t},\n\tcompany: function(frm) {\n\t\t\tfrm.doc.overdue_days='';\n\t\t\tfrm.doc.credit_limit='';\n\t\t\tfrm.doc.customer_outstanding='';\n\t\tif (frm.doc.company && frm.doc.customer){\n\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_reports.api.customer_outstanding\",\n\t\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\t\tcompany: frm.doc.company,\n\t\t\t\t\t\tcustomer: frm.doc.customer,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(p.message) {\n\t\t\t\t\t\t\tfrm.doc.customer_outstanding=p.message\n\t\t\t\t\t\t\tfrm.refresh_field('customer_outstanding');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_reports.api.customer_overdue\",\n\t\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\t\tcompany: frm.doc.company,\n\t\t\t\t\t\tcustomer: frm.doc.customer,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(p.message) {\n\t\t\t\t\t\t\tfrm.doc.overdue_days=p.message\n\t\t\t\t\t\t\tfrm.refresh_field('overdue_days');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tfrappe.call({\n\t\t\t\t\tmethod: \"custom_reports.api.customer_credit\",\n\t\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\t\tcompany: frm.doc.company,\n\t\t\t\t\t\tcustomer: frm.doc.customer,\n\t\t\t\t\t},\n\t\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\t\n\t\t\t\t\t\tif(p.message) {\n\t\t\t\t\t\t\tfrm.doc.credit_limit=p.message\n\t\t\t\t\t\t\tfrm.refresh_field('credit_limit');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n    \t} \n\t}\n});\n\ncur_frm.fields_dict.property.get_query = function(doc) {\n\treturn {\n\t\tfilters: {\n\t\t\tcompany: doc.company\n\t\t}\n\t}\n}\n\nfrappe.ui.form.on('Sales Order Item',{\nitem_code:function(frm,cdt,cdn){\n\tif(frm.doc.company==\"AL NOKHBA BUILDING\")\n\t{\n\t\tif(frm.doc.contract_end_date && frm.doc.contract_start_date)\n\t\t{\n\t\t\tvar date1 = new Date(frm.doc.contract_start_date);\n\t\t\tvar date2 = new Date(frm.doc.contract_end_date);\n\t\t\tvar Difference_In_Time = date2.getTime() - date1.getTime();\n\t\t\tvar Difference_In_Days = Difference_In_Time / (1000 * 3600 * 24);\t\t\n\t\t\tlet item=locals[cdt][cdn];\n\t\t\titem.qty=Difference_In_Days;\n\t\t}\n\t}\n}\n});",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Purchase Order",
  "enabled": 1,
  "modified": "2022-12-13 15:33:03.965170",
  "name": "Purchase Order-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Purchase Order', {\n\tsupplier_quotation_comparison: function(frm) {\n\n\t    frappe.call({\n\t\t\t\tmethod: \"custom_reports.quotation.quotation_comparison\",\n\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\tpurchase_order: frm.doc.name,\n\t\t\t\t},\n\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\n\t\t\t\t\tif(p.message.suplier.length) {\n\t\t\t\t\t    var subtit='';\n\t\t\t\t\t    var msg='<style>table, th, td {  border: 1px solid #ebeef0;} th, td {  padding: 10px; }</style><table style=\"width:100%;\"><tr><th rowspan=\"2\">Item</th><th rowspan=\"2\">LPO Qty</th><th rowspan=\"2\">UOM</th>';\n\t\t\t\t\t\t$.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<th colspan=\"2\">'+su.supplier_name+'</th>';\n\t\t\t\t\t\t\tsubtit+='<th>Unit Price</th><th>Total Amount</th>';\n\t\t\t\t\t\t})\n\t\t\t\t\t\tmsg+='<th rowspan=\"2\">Last Purchase rate</th>';\n\t\t\t\t\t\t\tmsg+='<th rowspan=\"2\">Company Stock</th><th rowspan=\"2\">Orders in Pipe Line</th></tr>';\n\t\t\t\t\t\tmsg+='<tr>'+subtit+'</tr>';\n\t\t\t\t\t$.each(p.message.items, function(i, qto) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tmsg+='<tr><td>'+qto.item_code+'</td><td style=\"text-align:right;\">'+qto.qty+'</td><td>'+qto.uom+'</td>';\n\n\t\t\t\t\t\t$.each(qto.sup,function(k,supr){\n\t\t\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+supr.rate+'</td>';\n\t\t\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+supr.amount+'</td>';\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+qto.last_purchase_rate+'</td>';\n\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+qto.company_total_stock+'</td>';\n\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+qto.orditmcnt+'</td>';\n\t\t\t\t\t\tmsg+='</tr>';\n\t\t\t\t\t})\n                    msg+='<tr><td>Discount</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" style=\"text-align:right;\">'+su.discount_amount+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t msg+='<td></td><td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\t  msg+='<tr><td>Total Price Of Items</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" style=\"text-align:right;\">'+su.total+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\tmsg+='<td></td><td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\t msg+='<tr><td>Warranty</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" >'+(su.warranty?su.warranty:'')+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t msg+='<td></td><td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\t msg+='<tr><td>Payment Terms</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" >'+(su.payment_terms?su.payment_terms:'')+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t msg+='<td></td><td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\t  msg+='<tr><td>Other Notes</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" >'+(su.other_notes?su.other_notes:'')+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t msg+='<td></td><td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\tmsg+='</table>';\n\t\t\t\t\t var d = new frappe.ui.Dialog({\n\t\t\t\t\t    title: 'Supplier Quotation Comparisontion',\n    'fields': [\n        {'fieldname': 'ht', 'fieldtype': 'HTML'},\n    ]\n});\nd.fields_dict.ht.$wrapper.html(msg);\nd.$wrapper.find('.modal-dialog').css(\"max-width\", \"90%\");\nd.$wrapper.find('.modal-dialog').css(\"width\", \"90%\");\nd.show();\n\t\t\t\t\t\t\n\t\t\t\t\t}else{\n\t\t\t\t\t    \n\t\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\ttitle: __('Supplier Quotation Comparisontion'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tmessage: __('Quotation are not available')\n\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t    \n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Material Request",
  "enabled": 1,
  "modified": "2023-06-19 17:45:37.389180",
  "name": "Material Request-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Material Request', {\n\trefresh(frm) {\n\tfrm.set_query(\"asset_sub_group\", function() {\n\t\t\treturn {\n\t\t\t\tfilters: {\"asset_group\": frm.doc.asset_group}\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\tfrappe.call({\n    method:\"custom_reports.api.get_value_from_jv\",\n    args: {\n        name:frm.doc.name,\n    }, \n    callback: function(r) {        \n        /*cur_frm.set_value('actual_rate', r.message.amount);\n        cur_frm.set_value('journal_entry', r.message.jv_entry);\n\t\trefresh_field('actual_rate');\n\t\trefresh_field('journal_entry');\n\t\tif(r.message>0){\n\t\tlet amount=frm.doc.total-frm.doc.actual_rate;\n\t    cur_frm.set_value('balance', amount);\n        refresh_field('balance');\n\t\t}*/\n    }\n});\n\n\n\t\n\t},\n\tview_cash_balance:function(frm){\n\t     \n\t   frappe.call({\n\t\t\t\t\tmethod: 'custom_reports.custom_reports.page.material_request_set.material_request_set.get_report',\n\t\t\t\t\tfreeze: 1,\n\t\t\t\t\tfreeze_message: 'Data loading ...please waite',\n\t\t\t\t\targs: {\n\t\t\t\t\t  company: frm.doc.company\t\t\t\t  \t\t\t\t\t  \n\t\t\t\t\t},\n\t\t\t\t\tcallback: function (r) {\n\t\t\t\t\t  if (r.message) {\n\t\t\t\t\t\t\n\t\t\t\t\t\t  var d = new frappe.ui.Dialog({\n\t\t\t\t\t\t\ttitle: 'Material And PRO Request - Settlement',\n\t\t\t\t\t\t\t'fields': [\n\t\t\t\t\t\t\t\t{'fieldname': 'ht', 'fieldtype': 'HTML'},\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t});\n\t\t\t\t\t\td.fields_dict.ht.$wrapper.html(r.message);\n\t\t\t\t\t\td.$wrapper.find('.modal-dialog').css(\"max-width\", \"50%\");\n\t\t\t\t\t\td.$wrapper.find('.modal-dialog').css(\"width\", \"50%\");\n\t\t\t\t\t\td.show();\n\t\t\t\t\t\t \n\t\t\t\t\t\t \n\t\t\t\t\t  }\n\t\t\t\t\t},\n\t\t\t\t  });   \n\t },\n\tasset_sub_group(frm)\n\t{\n\t    frappe.call({\n\t\t\t\t\tmethod: 'custom_reports.api.maintanse_items',\n\t\t\t\t\t\targs: {\n\t\t\t\t\t\t\t'sub_gp': frm.doc.asset_sub_group\n\t\t\t\t\t},\n\t\t\t\t\tcallback: function(data) {\n\t\t\t\t\t\tlet itm=[];\n\t\t\t\t\t\tif(data.message)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t(data.message || []).forEach(function(row) {\n\t\t\t\t\t\t\titm.push(row.sub_group_items);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\n\t\t\t\t\t\t\tset_field_options(\"asset_item\", itm)\n\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}); \n\t},actual_rate(frm){\n\t    let amount=frm.doc.total-frm.doc.actual_rate;\n\t    cur_frm.set_value('balance', amount);\n        refresh_field('balance');\n\t}\n});\nfrappe.ui.form.on('Material Request Item', {\n\titem_code(frm, cdt, cdn){\n\t\tvar d = locals[cdt][cdn];\n\t\tvar total = 0;\n\t\tfrm.doc.items.forEach(function(d) { total += d.amount; });\n\t\tfrm.set_value(\"total\", total);\n\t\trefresh_field(\"total\");\n\t\t\t},\n\t\t\t\tqty(frm, cdt, cdn){\n\t\tvar d = locals[cdt][cdn];\n\t\tvar total = 0;\n\t\tfrm.doc.items.forEach(function(d) { total += d.amount; });\n\t\tfrm.set_value(\"total\", total);\n\t\trefresh_field(\"total\");\n\t\t\t},\n\t\t\t\trate(frm, cdt, cdn){\n\t\tvar d = locals[cdt][cdn];\n\t\tvar total = 0;\n\t\tfrm.doc.items.forEach(function(d) { total += d.amount; });\n\t\tfrm.set_value(\"total\", total);\n\t\trefresh_field(\"total\");\n\t\t\t}\n});\n\nfrappe.ui.form.on('Material Request', {\n\tsupplier_quotation_comparison: function(frm) {\n\n\t    frappe.call({\n\t\t\t\tmethod: \"custom_reports.quotation.quotation_comparison_mt\",\n\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\tmaterial_request: frm.doc.name,\n\t\t\t\t},\n\t\t\t\tcallback: function(p) {\n\t\t\t\t\t\n\t\t\t\t\tif(p.message.suplier.length) {\n\t\t\t\t\t    var subtit='';\n\t\t\t\t\t    var msg='<style>table, th, td {  border: 1px solid #ebeef0;} th, td {  padding: 10px; }</style><table style=\"width:100%;\"><tr><th rowspan=\"2\">Item</th><th rowspan=\"2\">Qty</th><th rowspan=\"2\">UOM</th>';\n\t\t\t\t\t\t$.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<th colspan=\"2\">'+su.supplier_name+'</th>';\n\t\t\t\t\t\t\tsubtit+='<th>Unit Price</th><th>Total Amount</th>';\n\t\t\t\t\t\t})\n\t\t\t\t\t\tmsg+='<th rowspan=\"2\">Last Purchase rate</th>';\n\t\t\t\t\t\t\tmsg+='<th rowspan=\"2\">Company Stock</th></tr>';\n\t\t\t\t\t\tmsg+='<tr>'+subtit+'</tr>';\n\t\t\t\t\t$.each(p.message.items, function(i, qto) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\tmsg+='<tr><td>'+qto.item_code+'</td><td style=\"text-align:right;\">'+qto.qty+'</td><td>'+qto.uom+'</td>';\n\n\t\t\t\t\t\t$.each(qto.sup,function(k,supr){\n\t\t\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+supr.rate+'</td>';\n\t\t\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+supr.amount+'</td>';\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+qto.last_purchase_rate+'</td>';\n\t\t\t\t\t\tmsg+='<td style=\"text-align:right;\">'+qto.company_total_stock+'</td>';\n\t\t\t\t\t\tmsg+='</tr>';\n\t\t\t\t\t})\n                    msg+='<tr><td>Discount</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" style=\"text-align:right;\">'+su.discount_amount+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t msg+='<td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\t  msg+='<tr><td>Total Price Of Items</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" style=\"text-align:right;\">'+su.total+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t  msg+='<td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\t msg+='<tr><td>Warranty</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" >'+(su.warranty?su.warranty:'')+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t  msg+='<td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\t msg+='<tr><td>Payment Terms</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" >'+(su.payment_terms?su.payment_terms:'')+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t  msg+='<td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\t  msg+='<tr><td>Other Notes</td><td></td><td></td>';\n                    $.each(p.message.suplier,function(j,su){\n\t\t\t\t\t\t\tmsg+='<td colspan=\"2\" >'+(su.other_notes?su.other_notes:'')+'</td>';\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t})\n\t\t\t\t\t  msg+='<td></td><td></td></tr>';\n\t\t\t\t\t \n\t\t\t\t\tmsg+='</table>';\n\t\t\t\t\t var d = new frappe.ui.Dialog({\n\t\t\t\t\t    title: 'Supplier Quotation Comparisontion',\n    'fields': [\n        {'fieldname': 'ht', 'fieldtype': 'HTML'},\n    ]\n});\nd.fields_dict.ht.$wrapper.html(msg);\nd.$wrapper.find('.modal-dialog').css(\"max-width\", \"90%\");\nd.$wrapper.find('.modal-dialog').css(\"width\", \"90%\");\nd.show();\n\t\t\t\t\t\t\n\t\t\t\t\t}else{\n\t\t\t\t\t    \n\t\t\t\t\t\tfrappe.msgprint({\n\t\t\t\t\t\ttitle: __('Supplier Quotation Comparisontion'),\n\t\t\t\t\t\tindicator: 'green',\n\t\t\t\t\t\tmessage: __('Quotation are not available')\n\t\t\t\t\t});\n\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t    \n\t}\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Leave Application",
  "enabled": 1,
  "modified": "2023-02-22 12:54:57.576179",
  "name": "Leave Application-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Leave Application', {\n    refresh(frm) {\n\t        \n\t      \n\t   \n\t},\n\tvalidate: function(frm) {\n\t    if (frm.doc.leave_type=='Pink Leave')\n\t    {\n\t        var days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];\n\t\t\tvar lday= ['Tuesday', 'Wednesday', 'Thursday'];\n\t\t\tvar date1 = new Date(frm.doc.from_date);  \n\t\t\tvar date2 = new Date(frm.doc.to_date);    \n\t\t\tvar time_difference = date2.getTime() - date1.getTime();    \n\t\t\tvar days_difference = time_difference / (1000 * 60 * 60 * 24);\n\n\t\t\tif (days_difference < 3)\n\t\t\t{\n\t\t\t\t\n\t\t\t\tif(!lday.includes(days[date1.getDay()]) || !lday.includes(days[date2.getDay()]))\n\t\t\t\t{\n\t\t\t\t\tfrappe.throw('Pink Leave is only can applied for Tuesday, Wednesday and Thursday');\n\t\t\t\t}\n\t\t\t\t\n\t\t\t}else{\n\t\t\t\tfrappe.throw('Pink Leave is only can applied for Tuesday, Wednesday and Thursday');\n\t\t\t}\n\n\t    }\n\t    \n\t},\n\temployee: function(frm) {\n\t\tif (frm.doc.leave_type=='Pink Leave' && frm.doc.employee)\n\t    {\n\t\t\tfrappe.db.get_doc('Employee', frm.doc.employee).then(docc => {        \n\t\t\tif(docc.gender=='Male')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfrm.doc.leave_type='';\n\t\t\t\t\t\t\trefresh_field(\"leave_type\");\n\t\t\t\t\t\t\tfrappe.throw('Leave type Pink Leave is only can applied for Female Employee');\n\t\t\t\t\t\t}\n    \t\t});\n\t\t\t\n\t\t}\n\t},\n\tleave_type: function(frm) {\n\t\tif (frm.doc.leave_type=='Pink Leave' && frm.doc.employee)\n\t    {\n\t\t\tfrappe.db.get_doc('Employee', frm.doc.employee).then(docc => {        \n\t\t\tif(docc.gender=='Male')\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tfrm.doc.leave_type='';\n\t\t\t\t\t\t\trefresh_field(\"leave_type\");\n\t\t\t\t\t\t\tfrappe.throw('Leave type Pink Leave is only can applied for Female Employee');\n\t\t\t\t\t\t}\n    \t\t});\n\t\t\t\n\t\t}\n\t},\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Annual Leave Payslip",
  "enabled": 0,
  "modified": "2023-06-22 18:09:25.082455",
  "name": "Annual Leave Payslip-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "// Copyright (c) 2023, alantech and contributors\n// For license information, please see license.txt\n\nfrappe.ui.form.on('Annual Leave Payslip', {\n\t refresh: function(frm) {\n\t\tfrm.set_query(\"leave_application\", function() {\n\t\t\treturn {\n\t\t\t\tfilters: {\"employee\": frm.doc.employee,'leave_type':'Annual Leave'}\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\t\n\t },\n\t on_submit: function(frm){\n\t     frappe.db.set_value('Leave Application', frm.doc.leave_application, 'salary_paid_in_advance', '1');\n\t    \n\t },\n\t after_cancel: function(frm){\n\t     frappe.db.set_value('Leave Application', frm.doc.leave_application, 'salary_paid_in_advance', '0');\n\t    \n\t },\n\t ending_date: function(frm) {\n\t\tfrm.trigger(\"get_annual_leave\");\n\t\tfrm.trigger(\"get_emp_detail\");\n\t\tfrm.trigger(\"get_tickets_given\");\n\t\tfrm.trigger(\"get_settlement_details\");\n\t\t\n\t },\n\t get_annual_leave: function(frm) {\n\n\t    if (frm.doc.docstatus === 0 && frm.doc.employee  && frm.doc.date_of_joining && frm.doc.ending_date) {\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: \"custom_reports.api.get_leave_balance_on\",\n\t\t\t\targs: {\n\t\t\t\t\temployee: frm.doc.employee,\n\t\t\t\t\tdate: frm.doc.starting_date,\n\t\t\t\t\tto_date: frm.doc.ending_date,\n\t\t\t\t},\n\t\t\t\tcallback: function (r) {\n\t\t\t\t\tif (r.message) {\n\t\t\t\t\t\tfrm.set_value('annual_leave', flt(r.message,3));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfrm.set_value('annual_leave', \"0\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},get_emp_detail: function(frm) {\n\n\t\tif (frm.doc.docstatus === 0 && frm.doc.employee && frm.doc.starting_date && frm.doc.ending_date) {\n\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: \"custom_reports.api.get_emp_details\",\n\t\t\t\targs: {\n\t\t\t\t\temp:frm.doc.employee,\t\t\t\t\t\n\t\t\t\t\tstart_date: frm.doc.starting_date,\n\t\t\t\t\tend_date:frm.doc.ending_date,\t\t\t\t\t\n\t\t\t\t},\n\t\t\t\tcallback: function (r) {\n\t\t\t\tif (r.message) {\t\t\t\t\t\t\n\t\t\t\t\t\tfrm.set_value('leaves_taken_during_this_year',r.message.leave_in_year);\t\t\t\t\t\t\n\t\t\t\t\t\tfrm.set_value('ticket_given',r.message.ticket_issued);\t\t\t\t\t\t\n\t\t\t\t\t\tfrm.set_value('ticket_period',r.message.ticket_period);\n\t\t\t\t\t\tfrm.set_value('used_leaves',r.message.used_leaves);\n\t\t\t\t\t\tfrm.set_value('leave_entitled',r.message.leave_entitled);\n\t\t\t\t\t\tfrm.set_value('salary_structure',r.message.salary_structure);\t\t\t\t\t\t\n\t\t\t\t\t\tfrm.set_value('ticket_eligible',r.message.ticket_eligible);\n\t\t\t\t\t\tfrm.set_value('gross_salary',r.message.gross_salary);\n\t\t\t\t\t\tfrm.set_value('base_salary',r.message.base_salary);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfrm.set_value('leaves_taken_during_this_year',\"0\");\n\t\t\t\t\t\tfrm.set_value('ticket_given',\"0\");\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\tfrm.set_value('ticket_period',\"0\");\n\t\t\t\t\t\tfrm.set_value('used_leaves',\"0\");\n\t\t\t\t\t\tfrm.set_value('leave_entitled',\"0\");\n\t\t\t\t\t\tfrm.set_value('salary_structure',\"0\");\t\t\t\t\t\t\n\t\t\t\t\t\tfrm.set_value('ticket_eligible',\"0\");\n\t\t\t\t\t\tfrm.set_value('gross_salary',\"0\");\n\t\t\t\t\t\tfrm.set_value('base_salary',\"0\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t}\n\t},get_tickets_given: function(frm) \n\t{\n\t\tif (frm.doc.docstatus === 0 && frm.doc.employee  && frm.doc.date_of_joining && frm.doc.ending_date) {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: \"custom_reports.api.get_ticket_given\",\n\t\t\t\targs: {\t\t\t\t\t\n\t\t\t\t\temp: frm.doc.employee,\n\t\t\t\t\tfrom_date: frm.doc.date_of_joining,\n\t\t\t\t\tto_date: frm.doc.starting_date,\t\t\t\n\t\t\t\t},\n\t\t\t\tcallback: function(p) {\n\t\t\t\t\tif(p.message) {\t\t\t\t\t\n\t\t\t\t\tfrm.doc.ticket_balance=p.message.balance;\n\t\t\t\t\tfrm.refresh_field('ticket_balance');\n\t\t\t\t\t\n\t\t\t\t\tfrm.doc.ticket_used=p.message.used;\n\t\t\t\t\tfrm.refresh_field('ticket_used');\n\t\t\t\t\t\t\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\tget_settlement_details:function(frm)\n\t{ \n\t\tif (frm.doc.docstatus === 0 && frm.doc.employee && frm.doc.starting_date && frm.doc.ending_date) {\n\t\t\treturn frappe.call({\n\t\t\t\tmethod: \"custom_reports.api.get_employee_salarys\",\n\t\t\t\targs: {\n\t\t\t\t\temp:frm.doc.employee,\t\t\t\t\t\n\t\t\t\t\tdate_from: frm.doc.starting_date,\n\t\t\t\t\tdate_to:frm.doc.ending_date,\n\n\t\t\t\t},\n\t\t\t\tcallback: function (r) {\n\t\t\t\t\tif (r.message) {\t\t\t\t\t\t\n\t\t\t\t\t\t$.each(r.message, function(i, jvd) {\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tvar c = frm.add_child(\"settlement_details\");\n\t\t\t\t\t\t\tc.settlement=jvd.salary_component;\n\t\t\t\t\t\t\tc.paid_amt=jvd.amount;\n\t\t\t\t\t\t\tc.gen_amt=jvd.amount;\n\t\t\t\t\t\t\tc.narration=jvd.narration;\n\t\t\t\t\t\t\tc.slip=jvd.slip;\n\t\t\t\t\t\t\tc.employee=jvd.employee;\n\t\t\t\t\t\t\tc.date_from=jvd.date_from;\n\t\t\t\t\t\t\tc.date_to=jvd.date_to;\n\t\t\t\t\t\t\tc.days=jvd.days;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tfrm.refresh_field(\"settlement_details\");\n\t\t\t\t\t\tfrm.trigger(\"calc_tot\");\n\t\t\t\t\t} \n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t},\n\tcalc_tot: function(frm)\n\t{\n\t\tvar tot=0;\n\t\tfrm.doc.settlement_details.forEach(function(d) { \n\t\t\tif(d.applied=='Yes')\n\t\t\t{\n\t\t\t\ttot+=Math.round(d.paid_amt,2);\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\tif(frm.doc.allowance_and_deducts){\n\t\t\tfrm.doc.allowance_and_deducts.forEach(function(d) { \n\t\t\t\t\n\t\t\t\tif(d.payment_type=='Deduction')\n\t\t\t\t{\n\t\t\t\t    tot-=Math.round(d.currency_amt,2);\n\t\t\t\t}else{\n\t\t\t\t\ttot+=Math.round(d.currency_amt,2);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t});\n\t\t}\n\t\tfrm.doc.total_amount=tot;\n\t\tfrm.refresh_field('total_amount');\n\t}\n});\n\nfrappe.ui.form.on('Allowance And Deducts', {\n    \n    currency_amt(frm, cdt, cdn) {\n       \n\t\tvar tot=0;\n\t\tfrm.doc.settlement_details.forEach(function(d) { \n\t\t\tif(d.applied=='Yes')\n\t\t\t{\n\t\t\t\ttot+=Math.round(d.paid_amt,2);\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\tif(frm.doc.allowance_and_deducts){\n\t\t\tfrm.doc.allowance_and_deducts.forEach(function(d) { \n\t\t\t\t\n\t\t\t\tif(d.payment_type=='Deduction')\n\t\t\t\t{\n\t\t\t\t    tot-=Math.round(d.currency_amt,2);\n\t\t\t\t}else{\n\t\t\t\t\ttot+=Math.round(d.currency_amt,2);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t});\n\t\t}\n\t\tfrm.doc.total_amount=tot;\n\t\tfrm.refresh_field('total_amount');\n    }\n})\n\nfrappe.ui.form.on('Settlement Details', {\n   \n    paid_amt(frm, cdt, cdn) {\n      \n\t\tvar tot=0;\n\t\tfrm.doc.settlement_details.forEach(function(d) { \n\t\t\tif(d.applied=='Yes')\n\t\t\t{\n\t\t\t\ttot+=Math.round(d.paid_amt,2);\n\t\t\t\t\n\t\t\t}\n\t\t});\n\t\tif(frm.doc.allowance_and_deducts){\n\t\t\tfrm.doc.allowance_and_deducts.forEach(function(d) { \n\t\t\t\t\n\t\t\t\tif(d.payment_type=='Deduction')\n\t\t\t\t{\n\t\t\t\t    tot-=Math.round(d.currency_amt,2);\n\t\t\t\t}else{\n\t\t\t\t\ttot+=Math.round(d.currency_amt,2);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t});\n\t\t}\n\t\tfrm.doc.total_amount=tot;\n\t\tfrm.refresh_field('total_amount');\n    }\n})",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Payroll Entry",
  "enabled": 1,
  "modified": "2023-06-06 14:19:45.382318",
  "name": "Payroll Entry-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Payroll Entry', {\n\trefresh(frm) {\n\t    \nvar companies=['Dure Oil Middle East Factory - Sole Proprietorship LLC', 'Head Office - Bin Butti Holding Group LLC', 'World Wide Emirates Services - Sole Proprietorship LLC', 'Bin Butti Rotating Machinery LLC', 'Quick Laundry \u2013 Sole Proprietorship LLC', 'Bin Butti International Real Estate Management \u2013 Unincorporated', 'Hamed General Trading &  Companies Representation - Sole Proprietorship LLC','ABU DHABI POULTRY FARM - SOLE PROPRIETORSHIP L.L.C.', 'ABU DHABI MODERNE POULTRY FARM L.L.C.'];\n\t\tif (companies.includes(frm.doc.company) && frappe.model.has_workflow(frm.doctype))\n\t\t{\n\t     if(frm.doc.workflow_state!='Approved'){\n        frm.remove_custom_button('Submit Salary Slip');\n\t    }\n\tsetTimeout(() => {\n\t    if(frm.doc.workflow_state!='Approved'){\n        frm.remove_custom_button('Submit Salary Slip');\n\t    }\n       \n        }, 10);\n        \n        if (!frm.doc.salary_slips_submitted && frm.doc.workflow_state=='Approved')\n        {\n\t\t\tfrm.doc.salary_slips_submitted=1;\n        \tsubmit_salary_slip(frm);\n        }\n        \n        if (frm.doc.docstatus == 0) {\n       if ((frm.doc.employees || []).length) {\n\t\t\t\tfrm.page.clear_primary_action();\n\t\t\t\tfrm.page.set_primary_action(__('Create Salary Slips'), () => {\n\t\t\t\t\tfrm.save('Submit').then(() => {\n\t\t\t\t\t\tfrm.page.clear_primary_action();\n\t\t\t\t\t\tfrm.refresh();\n\t\t\t\t\t\tfrm.events.refresh(frm);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n        }\n\t\t}else{\n\n\t\t\tif (frm.doc.docstatus == 0) {\n       if ((frm.doc.employees || []).length) {\n\t\t\t\tfrm.page.clear_primary_action();\n\t\t\t\tfrm.page.set_primary_action(__('Create Salary Slips'), () => {\n\t\t\t\t\tfrm.save('Submit').then(() => {\n\t\t\t\t\t\tfrm.page.clear_primary_action();\n\t\t\t\t\t\tfrm.refresh();\n\t\t\t\t\t\tfrm.events.refresh(frm);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n        }\n\t\t}\n        \n       \n\t},\n\temployee_salary_sheet(frm) {\n\t   var base_url = window.location.origin;\n                var url=base_url+'/app/employee-salary-shee/'+frm.doc.name\n\t\t\t\twindow.open(url, '_blank');\n\t},\n\tsalary_sheet_without_over_time(frm) {\n\t   var base_url = window.location.origin;\n                var url=base_url+'/app/salary-sheet-without/'+frm.doc.name\n\t\t\t\twindow.open(url, '_blank');\n\t},\n\tover_time_sheet(frm) {\n\t   var base_url = window.location.origin;\n                var url=base_url+'/app/over-time-sheet/'+frm.doc.name\n\t\t\t\twindow.open(url, '_blank');\n\t},\n\tsalary_comparison(frm) {\n\t   var base_url = window.location.origin;\n                var url=base_url+'/app/salary-comparison/'+frm.doc.name\n\t\t\t\twindow.open(url, '_blank');\n\t}\n})\n\nconst submit_salary_slip = function (frm) {\n\tfrappe.confirm(__('This will submit Salary Slips and create accrual Journal Entry. Do you want to proceed?'),\n\t\tfunction () {\n\t\t\tfrappe.call({\n\t\t\t\tmethod: 'submit_salary_slips',\n\t\t\t\targs: {},\n\t\t\t\tcallback: function () {\n\t\t\t\t\tfrm.events.refresh(frm);\n\t\t\t\t},\n\t\t\t\tdoc: frm.doc,\n\t\t\t\tfreeze: true,\n\t\t\t\tfreeze_message: __('Submitting Salary Slips and creating Journal Entry...')\n\t\t\t});\n\t\t},\n\t\tfunction () {\n\t\t\tif (frappe.dom.freeze_count) {\n\t\t\t\tfrappe.dom.unfreeze();\n\t\t\t\tfrm.events.refresh(frm);\n\t\t\t}\n\t\t}\n\t);\n};",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Leave Allocation",
  "enabled": 1,
  "modified": "2023-09-24 15:03:56.842765",
  "name": "Leave Allocation-Form",
  "parent": null,
  "parentfield": null,
  "parenttype": null,
  "script": "frappe.ui.form.on('Leave Allocation', {\n\trefresh(frm) {\n\t\t// your code here\n\t},\n\tleave_type: function(frm) {\n\t    if (frm.doc.leave_type=='Annual Leave' && frm.doc.to_date)\n        {\n        \tfrappe.call({\n        \t\t\t\tmethod: \"custom_reports.api.get_initial_annual_leave\",\n        \t\t\t\targs: {\n        \t\t\t\t\temp: frm.doc.employee,\n        \t\t\t\t\tleave_type: frm.doc.leave_type,\n        \t\t\t\t\tfrom_date: frm.doc.from_date,\n        \t\t\t\t\tto_date: frm.doc.to_date,\t\n        \t\t\t\t},\n        \t\t\t\tcallback: function(response) {\n        \t\t\t\t  if(!frm.doc.new_leaves_allocated  || frm.doc.new_leaves_allocated=='')\n        \t\t\t\t  {\n        \t\t\t\t      frm.doc.new_leaves_allocated=response.message;\n                                refresh_field(\"new_leaves_allocated\");\n        \t\t\t\t  }\n        \t\t\t\t}\n        \t\t\t  }); \n        }\n\t},\n\tfrom_date: function(frm) {\n\t    if (frm.doc.leave_type=='Annual Leave' && frm.doc.to_date)\n        {\n        \tfrappe.call({\n        \t\t\t\tmethod: \"custom_reports.api.get_initial_annual_leave\",\n        \t\t\t\targs: {\n        \t\t\t\t\temp: frm.doc.employee,\n        \t\t\t\t\tleave_type: frm.doc.leave_type,\n        \t\t\t\t\tfrom_date: frm.doc.from_date,\n        \t\t\t\t\tto_date: frm.doc.to_date,\t\n        \t\t\t\t},\n        \t\t\t\tcallback: function(response) {\n        \t\t\t\t  if(!frm.doc.new_leaves_allocated  || frm.doc.new_leaves_allocated=='')\n        \t\t\t\t  {\n        \t\t\t\t      frm.doc.new_leaves_allocated=response.message;\n                                refresh_field(\"new_leaves_allocated\");\n        \t\t\t\t  }\n        \t\t\t\t}\n        \t\t\t  }); \n        }\n\t},\n\tto_date: function(frm) {\n\t    if (frm.doc.leave_type=='Annual Leave' && frm.doc.to_date)\n        {\n        \tfrappe.call({\n        \t\t\t\tmethod: \"custom_reports.api.get_initial_annual_leave\",\n        \t\t\t\targs: {\n        \t\t\t\t\temp: frm.doc.employee,\n        \t\t\t\t\tleave_type: frm.doc.leave_type,\n        \t\t\t\t\tfrom_date: frm.doc.from_date,\n        \t\t\t\t\tto_date: frm.doc.to_date,\t\n        \t\t\t\t},\n        \t\t\t\tcallback: function(response) {\n        \t\t\t\t  if(!frm.doc.new_leaves_allocated  || frm.doc.new_leaves_allocated=='')\n        \t\t\t\t  {\n        \t\t\t\t      frm.doc.new_leaves_allocated=response.message;\n                                refresh_field(\"new_leaves_allocated\");\n        \t\t\t\t  }\n        \t\t\t\t}\n        \t\t\t  }); \n        }\n\t},\n\t\n})",
  "view": "Form"
 }
]